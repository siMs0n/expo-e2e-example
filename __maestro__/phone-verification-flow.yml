appId: com.simoncnielsen.expoe2eexample.dev
---
# Test the phone verification flow

- launchApp

- tapOn:
    id: logo
- tapOn:
    id: reset-backend
- tapOn:
    id: set-phone-unverified
- tapOn:
    id: close-e2e-modal

- runFlow:
    file: helpers/login-mock.yml

# Wait for Home screen to be visible
- assertVisible: "Hello Simon!"

# Assert that verification prompt is visible
- assertVisible: "Please verify your phone number"

- runFlow:
    file: sub-flows/verify-phone-number.yml

# Assert verification prompt is no longer visible
- assertNotVisible: "Please verify your phone number"

# Navigate to Profile tab
- tapOn: "Profile"

# Assert Profile screen is visible
- assertVisible: "Phone Number"

# Update phone number
- tapOn:
    id: phone-input
- eraseText
- inputText: "+9876543210"

# Save the new phone number
- tapOn: "Save"

# Wait for save to complete
- waitForAnimationToEnd

# Save the new phone number
- tapOn: "OK"

# Assert that verification prompt appears after phone number change
- assertVisible: "Please verify your phone number"

- runFlow:
    file: sub-flows/verify-phone-number.yml

# Assert verification prompt is no longer visible
- assertNotVisible: "Please verify your phone number"
